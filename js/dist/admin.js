module.exports=function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=20)}([function(e,t){e.exports=flarum.core.compat.app},function(e,t){e.exports=flarum.core.compat.Model},function(e,t,n){"use strict";function r(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,e.__proto__=t}n.d(t,"a",(function(){return r}))},function(e,t){e.exports=flarum.core.compat["helpers/icon"]},function(e,t){e.exports=flarum.core.compat.extend},function(e,t){e.exports=flarum.core.compat["components/Button"]},function(e,t){e.exports=flarum.core.compat["utils/mixin"]},,function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(2),o=n(1),a=n.n(o),i=n(6),s=function(e){function t(){return e.apply(this,arguments)||this}return Object(r.a)(t,e),t.prototype.apiEndpoint=function(){return"/masquerade/fields"+(this.exists?"/"+this.data.id:"")},t}(n.n(i)()(a.a,{name:a.a.attribute("name"),description:a.a.attribute("description"),type:a.a.attribute("type"),validation:a.a.attribute("validation"),required:a.a.attribute("required"),prefix:a.a.attribute("prefix"),icon:a.a.attribute("icon"),sort:a.a.attribute("sort"),deleted_at:a.a.attribute("deleted_at",a.a.transformDate),answer:a.a.hasOne("answer"),on_bio:a.a.attribute("on_bio")}))},function(e,t){e.exports=flarum.core.compat["components/Select"]},function(e,t){e.exports=flarum.core.compat.Component},function(e,t){e.exports=flarum.core.compat["components/Switch"]},function(e,t){e.exports=flarum.core.compat["components/PermissionGrid"]},,,,function(e,t){e.exports=flarum.core.compat["components/AdminNav"]},function(e,t){e.exports=flarum.core.compat["components/AdminLinkButton"]},function(e,t){e.exports=flarum.core.compat["utils/saveSettings"]},,function(e,t,n){"use strict";n.r(t);var r=n(4),o=n(0),a=n.n(o),i=n(12),s=n.n(i),l=n(8),d=n(16),u=n.n(d),f=n(17),c=n.n(f),p=n(2);function h(e,t,n){if(void 0===n)return e&&e.h5s&&e.h5s.data&&e.h5s.data[t];e.h5s=e.h5s||{},e.h5s.data=e.h5s.data||{},e.h5s.data[t]=n}var g=function(e,t){if(!(e instanceof NodeList||e instanceof HTMLCollection||e instanceof Array))throw new Error("You must provide a nodeList/HTMLCollection/Array of elements to be filtered.");return"string"!=typeof t?Array.from(e):Array.from(e).filter((function(e){return 1===e.nodeType&&e.matches(t)}))},v=new Map,b=function(){function e(){this._config=new Map,this._placeholder=void 0,this._data=new Map}return Object.defineProperty(e.prototype,"config",{get:function(){var e={};return this._config.forEach((function(t,n){e[n]=t})),e},set:function(e){if("object"!=typeof e)throw new Error("You must provide a valid configuration object to the config setter.");var t=Object.assign({},e);this._config=new Map(Object.entries(t))},enumerable:!0,configurable:!0}),e.prototype.setConfig=function(e,t){if(!this._config.has(e))throw new Error("Trying to set invalid configuration item: "+e);this._config.set(e,t)},e.prototype.getConfig=function(e){if(!this._config.has(e))throw new Error("Invalid configuration item requested: "+e);return this._config.get(e)},Object.defineProperty(e.prototype,"placeholder",{get:function(){return this._placeholder},set:function(e){if(!(e instanceof HTMLElement)&&null!==e)throw new Error("A placeholder must be an html element or null.");this._placeholder=e},enumerable:!0,configurable:!0}),e.prototype.setData=function(e,t){if("string"!=typeof e)throw new Error("The key must be a string.");this._data.set(e,t)},e.prototype.getData=function(e){if("string"!=typeof e)throw new Error("The key must be a string.");return this._data.get(e)},e.prototype.deleteData=function(e){if("string"!=typeof e)throw new Error("The key must be a string.");return this._data.delete(e)},e}(),y=function(e){if(!(e instanceof HTMLElement))throw new Error("Please provide a sortable to the store function.");return v.has(e)||v.set(e,new b),v.get(e)};function w(e,t,n){if(e instanceof Array)for(var r=0;r<e.length;++r)w(e[r],t,n);else e.addEventListener(t,n),y(e).setData("event"+t,n)}function E(e,t){if(e instanceof Array)for(var n=0;n<e.length;++n)E(e[n],t);else e.removeEventListener(t,y(e).getData("event"+t)),y(e).deleteData("event"+t)}function x(e,t,n){if(e instanceof Array)for(var r=0;r<e.length;++r)x(e[r],t,n);else e.setAttribute(t,n)}function q(e,t){if(e instanceof Array)for(var n=0;n<e.length;++n)q(e[n],t);else e.removeAttribute(t)}var T=function(e){if(!e.parentElement||0===e.getClientRects().length)throw new Error("target element must be part of the dom");var t=e.getClientRects()[0];return{left:t.left+window.pageXOffset,right:t.right+window.pageXOffset,top:t.top+window.pageYOffset,bottom:t.bottom+window.pageYOffset}},C=function(e,t){if(!(e instanceof HTMLElement&&(t instanceof NodeList||t instanceof HTMLCollection||t instanceof Array)))throw new Error("You must provide an element and a list of elements.");return Array.from(t).indexOf(e)},F=function(e){if(!(e instanceof HTMLElement))throw new Error("Element is not a node element.");return null!==e.parentNode},O=function(e,t,n){if(!(e instanceof HTMLElement&&e.parentElement instanceof HTMLElement))throw new Error("target and element must be a node");e.parentElement.insertBefore(t,"before"===n?e:e.nextElementSibling)},S=function(e,t){return O(e,t,"after")},L=function(e){if(!(e instanceof HTMLElement))throw new Error("You must provide a valid dom element");var t=window.getComputedStyle(e);return["height","padding-top","padding-bottom"].map((function(e){var n=parseInt(t.getPropertyValue(e),10);return isNaN(n)?0:n})).reduce((function(e,t){return e+t}))},_=function(e){if(!(e instanceof HTMLElement))throw new Error("You must provide a valid dom element");var t=window.getComputedStyle(e);return["width","padding-left","padding-right"].map((function(e){var n=parseInt(t.getPropertyValue(e),10);return isNaN(n)?0:n})).reduce((function(e,t){return e+t}))},A=function(e,t){if(!(e instanceof Array))throw new Error("You must provide a Array of HTMLElements to be filtered.");return"string"!=typeof t?e:e.filter((function(e){return e.querySelector(t)instanceof HTMLElement||e.shadowRoot&&e.shadowRoot.querySelector(t)instanceof HTMLElement})).map((function(e){return e.querySelector(t)||e.shadowRoot&&e.shadowRoot.querySelector(t)}))},M=function(e){return e.composedPath&&e.composedPath()[0]||e.target},I=function(e,t,n){return{element:e,posX:n.pageX-t.left,posY:n.pageY-t.top}},D=function(e,t){if(!0===e.isSortable){var n=y(e).getConfig("acceptFrom");if(null!==n&&!1!==n&&"string"!=typeof n)throw new Error('HTML5Sortable: Wrong argument, "acceptFrom" must be "null", "false", or a valid selector string.');if(null!==n)return!1!==n&&n.split(",").filter((function(e){return e.length>0&&t.matches(e)})).length>0;if(e===t)return!0;if(void 0!==y(e).getConfig("connectWith")&&null!==y(e).getConfig("connectWith"))return y(e).getConfig("connectWith")===y(t).getConfig("connectWith")}return!1},H={items:null,connectWith:null,disableIEFix:null,acceptFrom:null,copy:!1,placeholder:null,placeholderClass:"sortable-placeholder",draggingClass:"sortable-dragging",hoverClass:!1,debounce:0,throttleTime:100,maxItems:0,itemSerializer:void 0,containerSerializer:void 0,customDragImage:null,orientation:"vertical"};var P,j,B,Y,N,k,R,z,W,U=function(e,t){if("string"==typeof y(e).getConfig("hoverClass")){var n=y(e).getConfig("hoverClass").split(" ");!0===t?(w(e,"mousemove",function(e,t){var n=this;if(void 0===t&&(t=250),"function"!=typeof e)throw new Error("You must provide a function as the first argument for throttle.");if("number"!=typeof t)throw new Error("You must provide a number as the second argument for throttle.");var r=null;return function(){for(var o=[],a=0;a<arguments.length;a++)o[a]=arguments[a];var i=Date.now();(null===r||i-r>=t)&&(r=i,e.apply(n,o))}}((function(t){0===t.buttons&&g(e.children,y(e).getConfig("items")).forEach((function(e){var r,o;e!==t.target?(r=e.classList).remove.apply(r,n):(o=e.classList).add.apply(o,n)}))}),y(e).getConfig("throttleTime"))),w(e,"mouseleave",(function(){g(e.children,y(e).getConfig("items")).forEach((function(e){var t;(t=e.classList).remove.apply(t,n)}))}))):(E(e,"mousemove"),E(e,"mouseleave"))}},X=function(e){E(e,"dragstart"),E(e,"dragend"),E(e,"dragover"),E(e,"dragenter"),E(e,"drop"),E(e,"mouseenter"),E(e,"mouseleave")},G=function(e){var t;(t=e).h5s&&delete t.h5s.data,q(e,"aria-dropeffect")},V=function(e){q(e,"aria-grabbed"),q(e,"aria-copied"),q(e,"draggable"),q(e,"role")};function J(e,t){if(t.composedPath)return t.composedPath().find((function(e){return e.isSortable}));for(;!0!==e.isSortable;)e=e.parentElement;return e}function K(e,t){var n=h(e,"opts"),r=g(e.children,n.items).filter((function(e){return e.contains(t)||e.shadowRoot&&e.shadowRoot.contains(t)}));return r.length>0?r[0]:t}var Q=function(e){var t=h(e,"opts"),n=g(e.children,t.items),r=A(n,t.handle);(x(e,"aria-dropeffect","move"),h(e,"_disabled","false"),x(r,"draggable","true"),!1===t.disableIEFix)&&("function"==typeof(document||window.document).createElement("span").dragDrop&&w(r,"mousedown",(function(){if(-1!==n.indexOf(this))this.dragDrop();else{for(var e=this.parentElement;-1===n.indexOf(e);)e=e.parentElement;e.dragDrop()}})))};function Z(e,t){var n=String(t);return t=t||{},"string"==typeof e&&(e=document.querySelectorAll(e)),e instanceof HTMLElement&&(e=[e]),e=Array.prototype.slice.call(e),/serialize/.test(n)?e.map((function(e){var t=h(e,"opts");return function(e,t,n){if(void 0===t&&(t=function(e,t){return e}),void 0===n&&(n=function(e){return e}),!(e instanceof HTMLElement)||!0==!e.isSortable)throw new Error("You need to provide a sortableContainer to be serialized.");if("function"!=typeof t||"function"!=typeof n)throw new Error("You need to provide a valid serializer for items and the container.");var r=h(e,"opts").items,o=g(e.children,r),a=o.map((function(t){return{parent:e,node:t,html:t.outerHTML,index:C(t,o)}}));return{container:n({node:e,itemCount:a.length}),items:a.map((function(n){return t(n,e)}))}}(e,t.itemSerializer,t.containerSerializer)})):(e.forEach((function(e){if(/enable|disable|destroy/.test(n))return Z[n](e);["connectWith","disableIEFix"].forEach((function(e){Object.prototype.hasOwnProperty.call(t,e)&&null!==t[e]&&console.warn('HTML5Sortable: You are using the deprecated configuration "'+e+'". This will be removed in an upcoming version, make sure to migrate to the new options when updating.')})),t=Object.assign({},H,y(e).config,t),y(e).config=t,h(e,"opts",t),e.isSortable=!0,function(e){var t=h(e,"opts"),n=g(e.children,t.items),r=A(n,t.handle);h(e,"_disabled","false"),X(n),E(r,"mousedown"),E(e,"dragover"),E(e,"dragenter"),E(e,"drop")}(e);var r,o=g(e.children,t.items);if(null!==t.placeholder&&void 0!==t.placeholder){var a=document.createElement(e.tagName);t.placeholder instanceof HTMLElement?a.appendChild(t.placeholder):a.innerHTML=t.placeholder,r=a.children[0]}y(e).placeholder=function(e,t,n){var r;if(void 0===n&&(n="sortable-placeholder"),!(e instanceof HTMLElement))throw new Error("You must provide a valid element as a sortable.");if(!(t instanceof HTMLElement)&&void 0!==t)throw new Error("You must provide a valid element as a placeholder or set ot to undefined.");return void 0===t&&(["UL","OL"].includes(e.tagName)?t=document.createElement("li"):["TABLE","TBODY"].includes(e.tagName)?(t=document.createElement("tr")).innerHTML='<td colspan="100"></td>':t=document.createElement("div")),"string"==typeof n&&(r=t.classList).add.apply(r,n.split(" ")),t}(e,r,t.placeholderClass),h(e,"items",t.items),t.acceptFrom?h(e,"acceptFrom",t.acceptFrom):t.connectWith&&h(e,"connectWith",t.connectWith),Q(e),x(o,"role","option"),x(o,"aria-grabbed","false"),U(e,!0),w(e,"dragstart",(function(e){var n=M(e);if(!0!==n.isSortable&&(e.stopImmediatePropagation(),(!t.handle||n.matches(t.handle))&&"false"!==n.getAttribute("draggable"))){var r=J(n,e),o=K(r,n);R=g(r.children,t.items),N=R.indexOf(o),k=C(o,r.children),Y=r,function(e,t,n){if(!(e instanceof Event))throw new Error("setDragImage requires a DragEvent as the first argument.");if(!(t instanceof HTMLElement))throw new Error("setDragImage requires the dragged element as the second argument.");if(n||(n=I),e.dataTransfer&&e.dataTransfer.setDragImage){var r=n(t,T(t),e);if(!(r.element instanceof HTMLElement)||"number"!=typeof r.posX||"number"!=typeof r.posY)throw new Error("The customDragImage function you provided must return and object with the properties element[string], posX[integer], posY[integer].");e.dataTransfer.effectAllowed="copyMove",e.dataTransfer.setData("text/plain",M(e).id),e.dataTransfer.setDragImage(r.element,r.posX,r.posY)}}(e,o,t.customDragImage),j=L(o),B=_(o),o.classList.add(t.draggingClass),P=function(e,t){var n=e;return!0===y(t).getConfig("copy")&&(x(n=e.cloneNode(!0),"aria-copied","true"),e.parentElement.appendChild(n),n.style.display="none",n.oldDisplay=e.style.display),n}(o,r),x(P,"aria-grabbed","true"),r.dispatchEvent(new CustomEvent("sortstart",{detail:{origin:{elementIndex:k,index:N,container:Y},item:P,originalTarget:n}}))}})),w(e,"dragenter",(function(t){var n=M(t),r=J(n,t);r&&r!==z&&(W=g(r.children,h(r,"items")).filter((function(t){return t!==y(e).placeholder})),r.dispatchEvent(new CustomEvent("sortenter",{detail:{origin:{elementIndex:k,index:N,container:Y},destination:{container:r,itemsBeforeUpdate:W},item:P,originalTarget:n}}))),z=r})),w(e,"dragend",(function(n){if(P){P.classList.remove(t.draggingClass),x(P,"aria-grabbed","false"),"true"===P.getAttribute("aria-copied")&&"true"!==h(P,"dropped")&&P.remove(),P.style.display=P.oldDisplay,delete P.oldDisplay;var r=Array.from(v.values()).map((function(e){return e.placeholder})).filter((function(e){return e instanceof HTMLElement})).filter(F)[0];r&&r.remove(),e.dispatchEvent(new CustomEvent("sortstop",{detail:{origin:{elementIndex:k,index:N,container:Y},item:P}})),z=null,P=null,j=null,B=null}})),w(e,"drop",(function(n){if(D(e,P.parentElement)){n.preventDefault(),n.stopPropagation(),h(P,"dropped","true");var r=Array.from(v.values()).map((function(e){return e.placeholder})).filter((function(e){return e instanceof HTMLElement})).filter(F)[0];S(r,P),r.remove(),e.dispatchEvent(new CustomEvent("sortstop",{detail:{origin:{elementIndex:k,index:N,container:Y},item:P}}));var o=y(e).placeholder,a=g(Y.children,t.items).filter((function(e){return e!==o})),i=!0===this.isSortable?this:this.parentElement,s=g(i.children,h(i,"items")).filter((function(e){return e!==o})),l=C(P,Array.from(P.parentElement.children).filter((function(e){return e!==o}))),d=C(P,s);k===l&&Y===i||e.dispatchEvent(new CustomEvent("sortupdate",{detail:{origin:{elementIndex:k,index:N,container:Y,itemsBeforeUpdate:R,items:a},destination:{index:d,elementIndex:l,container:i,itemsBeforeUpdate:W,items:s},item:P}}))}}));var i,s,l,d=(i=function(e,n,r,o){if(P)if(t.forcePlaceholderSize&&(y(e).placeholder.style.height=j+"px",y(e).placeholder.style.width=B+"px"),Array.from(e.children).indexOf(n)>-1){var a=L(n),i=_(n),s=C(y(e).placeholder,n.parentElement.children),l=C(n,n.parentElement.children);if(a>j||i>B){var d=a-j,u=i-B,f=T(n).top,c=T(n).left;if(s<l&&("vertical"===t.orientation&&o<f||"horizontal"===t.orientation&&r<c))return;if(s>l&&("vertical"===t.orientation&&o>f+a-d||"horizontal"===t.orientation&&r>c+i-u))return}void 0===P.oldDisplay&&(P.oldDisplay=P.style.display),"none"!==P.style.display&&(P.style.display="none");var p=!1;try{var m=T(n).top+n.offsetHeight/2,h=T(n).left+n.offsetWidth/2;p="vertical"===t.orientation&&o>=m||"horizontal"===t.orientation&&r>=h}catch(e){p=s<l}p?S(n,y(e).placeholder):function(e,t){O(e,t,"before")}(n,y(e).placeholder),Array.from(v.values()).filter((function(e){return void 0!==e.placeholder})).forEach((function(t){t.placeholder!==y(e).placeholder&&t.placeholder.remove()}))}else{var b=Array.from(v.values()).filter((function(e){return void 0!==e.placeholder})).map((function(e){return e.placeholder}));-1!==b.indexOf(n)||e!==n||g(n.children,t.items).length||(b.forEach((function(e){return e.remove()})),n.appendChild(y(e).placeholder))}},void 0===(s=t.debounce)&&(s=0),function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];clearTimeout(l),l=setTimeout((function(){i.apply(void 0,e)}),s)}),u=function(e){var t=e.target,n=!0===t.isSortable?t:J(t,e);if(t=K(n,t),P&&D(n,P.parentElement)&&"true"!==h(n,"_disabled")){var r=h(n,"opts");parseInt(r.maxItems)&&g(n.children,h(n,"items")).length>=parseInt(r.maxItems)&&P.parentElement!==n||(e.preventDefault(),e.stopPropagation(),e.dataTransfer.dropEffect=!0===y(n).getConfig("copy")?"copy":"move",d(n,t,e.pageX,e.pageY))}};w(o.concat(e),"dragover",u),w(o.concat(e),"dragenter",u)})),e)}Z.destroy=function(e){!function(e){var t=h(e,"opts")||{},n=g(e.children,t.items),r=A(n,t.handle);E(e,"dragover"),E(e,"dragenter"),E(e,"dragstart"),E(e,"dragend"),E(e,"drop"),G(e),E(r,"mousedown"),X(n),V(n),e.isSortable=!1}(e)},Z.enable=function(e){Q(e)},Z.disable=function(e){!function(e){var t=h(e,"opts"),n=g(e.children,t.items),r=A(n,t.handle);x(e,"aria-dropeffect","none"),h(e,"_disabled","true"),x(r,"draggable","false"),E(r,"mousedown")}(e)},Z.__testing={_data:h,_removeItemEvents:X,_removeItemData:V,_removeSortableData:G};var ee=Z,te=n(3),ne=n.n(te),re=n(10),oe=n.n(re),ae=n(9),ie=n.n(ae),se=n(11),le=n.n(se),de=n(5),ue=n.n(de),fe=n(18),ce=n.n(fe),pe=function(e){function t(){return e.apply(this,arguments)||this}Object(p.a)(t,e);var n=t.prototype;return n.init=function(){this.newOption=m.prop("")},n.view=function(){var e=this;return m(".Form-group",[m("label",a.a.translator.trans("fof-masquerade.admin.fields.options")),m("table",m("tbody",this.options().map((function(t,n){return m("tr",[m("td",m("input[type=text].FormControl",{oninput:m.withAttr("value",(function(t){e.updateOption(n,t)})),value:t})),m("td",m("button.Button",{onclick:function(){e.moveOption(n,-1)}},ne()("fas fa-chevron-up"))),m("td",m("button.Button",{onclick:function(){e.moveOption(n,1)}},ne()("fas fa-chevron-down"))),m("td",m("button.Button.Button--danger",{onclick:function(){e.deleteOption(n)}},ne()("fas fa-close")))])})))),m(".helpText",a.a.translator.trans("fof-masquerade.admin.fields.option-comma-warning")),m("table",m("tbody"),m("tr",[m("td",m("input[type=text].FormControl",{onchange:m.withAttr("value",this.newOption),value:this.newOption(),placeholder:a.a.translator.trans("fof-masquerade.admin.fields.option-new")})),m("td",m("button.Button.Button--primary",{onclick:function(){e.addOption()}},ne()("fas fa-plus")))]))])},n.updateRules=function(e){this.props.onchange("in:"+e.join(","))},n.options=function(){var e=this.props.value.split("|"),t=[];return e.forEach((function(e){var n=e.split(":",2);"in"===n[0]&&(t=n[1].split(","))})),t},n.updateOption=function(e,t){var n=this.options();n[e]=t,this.updateRules(n)},n.moveOption=function(e,t){var n=this.options(),r=e+t;if(!(r<0||r>n.length-1)){var o=n.splice(e,1);n.splice(r,0,o[0]),this.updateRules(n)}},n.deleteOption=function(e){var t=this.options();t.splice(e,1),this.updateRules(t)},n.addOption=function(){if(""!==this.newOption()){var e=this.options();e.push(this.newOption()),this.newOption(""),this.updateRules(e)}},t}(oe.a),me=function(e){function t(){return e.apply(this,arguments)||this}Object(p.a)(t,e);var n=t.prototype;return n.init=function(){this.resetNew(),this.loading=!1,this.existing=[],this.loadExisting(),this.enforceProfileCompletion=m.prop(1==a.a.data.settings["masquerade.force-profile-completion"])},n.config=function(){var e=this;ee(this.element.querySelector(".js-sortable-fields"),{handle:"legend"})[0].addEventListener("sortupdate",(function(){var t=e.$(".js-sortable-fields > .Field").map((function(){return $(this).data("id")})).get();e.updateSort(t)}))},n.view=function(){var e=this;return m(".ProfileConfigurePane",m(".container",[m("h1",a.a.translator.trans("fof-masquerade.admin.title")),m("h2",a.a.translator.trans("fof-masquerade.admin.general-options")),m("form",[m(".Form-group",le.a.component({state:this.enforceProfileCompletion(),onchange:this.updateSetting.bind(this,this.enforceProfileCompletion,"masquerade.force-profile-completion"),children:a.a.translator.trans("fof-masquerade.admin.fields.force-user-to-completion")}))]),m("h2",a.a.translator.trans("fof-masquerade.admin.fields.title")),m("form.js-sortable-fields",this.existing.map((function(t){return e.addField(t)}))),m("form",{onsubmit:this.submitAddField.bind(this)},[this.addField(this.new)])]))},n.updateSetting=function(e,t,n){var r;ce()(((r={})[t]=n,r)),e(n)},n.addField=function(e){var t=this,n=e.id();return m("fieldset.Field",{"data-id":e.id(),key:e.id()},[m("legend",[n?[ue.a.component({className:"Button Button--icon Button--danger",icon:"fas fa-trash",onclick:this.deleteField.bind(this,e)})," "]:null,m("span.Field-toggle",{onclick:function(e){return t.toggleField(e)}},[a.a.translator.trans("fof-masquerade.admin.fields."+(n?"edit":"add"),{field:e.name()})," ",ne()("fas fa-caret-down")])]),m(".Field-body",[m(".Form-group",[m("label",a.a.translator.trans("fof-masquerade.admin.fields.name")),m("input.FormControl",{value:e.name(),oninput:m.withAttr("value",this.updateExistingFieldInput.bind(this,"name",e))}),m("span.helpText",a.a.translator.trans("fof-masquerade.admin.fields.name-help"))]),m(".Form-group",[m("label",a.a.translator.trans("fof-masquerade.admin.fields.description")),m("input.FormControl",{value:e.description(),oninput:m.withAttr("value",this.updateExistingFieldInput.bind(this,"description",e))}),m("span.helpText",a.a.translator.trans("fof-masquerade.admin.fields.description-help"))]),m(".Form-group",[m("label",a.a.translator.trans("fof-masquerade.admin.fields.icon")),m("input.FormControl",{value:e.icon(),oninput:m.withAttr("value",this.updateExistingFieldInput.bind(this,"icon",e))}),m("span.helpText",a.a.translator.trans("fof-masquerade.admin.fields.icon-help",{a:m("a",{href:"https://fontawesome.com/icons?m=free",target:"_blank"})}))]),m(".Form-group",le.a.component({state:e.on_bio(),onchange:this.updateExistingFieldInput.bind(this,"on_bio",e),children:a.a.translator.trans("fof-masquerade.admin.fields.on_bio")})),m(".Form-group",le.a.component({state:e.required(),onchange:this.updateExistingFieldInput.bind(this,"required",e),children:a.a.translator.trans("fof-masquerade.admin.fields.required")})),m(".Form-group",[m("label",a.a.translator.trans("fof-masquerade.admin.fields.type")),ie.a.component({onchange:function(n){"null"===n&&(n=null),t.updateExistingFieldInput("type",e,n)},options:this.availableTypes(),value:e.type()})]),"select"===e.type()?pe.component({onchange:function(n){t.updateExistingFieldInput("validation",e,n)},value:e.validation()}):null,null===e.type()?m(".Form-group",[m("label",a.a.translator.trans("fof-masquerade.admin.fields.validation")),m("input.FormControl",{value:e.validation(),oninput:m.withAttr("value",this.updateExistingFieldInput.bind(this,"validation",e))}),m("span.helpText",a.a.translator.trans("fof-masquerade.admin.fields.validation-help",{a:m("a",{href:"https://laravel.com/docs/5.2/validation#available-validation-rules",target:"_blank"})}))]):null,m(".Form-group",m(".ButtonGroup",[ue.a.component({type:"submit",className:"Button Button--primary",children:a.a.translator.trans("fof-masquerade.admin.buttons."+(n?"edit":"add")+"-field"),loading:this.loading,disabled:!this.readyToAdd(e),onclick:this.updateExistingField.bind(this,e)}),n?ue.a.component({type:"submit",className:"Button Button--danger",children:a.a.translator.trans("fof-masquerade.admin.buttons.delete-field"),loading:this.loading,onclick:this.deleteField.bind(this,e)}):null]))])])},n.updateExistingFieldInput=function(e,t,n){var r;t.id()?t.pushAttributes(((r={})[e]=n,r)):t[e](n)},n.updateSort=function(e){var t={sort:e};a.a.request({method:"POST",url:a.a.forum.attribute("apiUrl")+"/masquerade/fields/order",data:t}).then(this.requestSuccess.bind(this))},n.toggleField=function(e){$(e.target).parents(".Field").toggleClass("active")},n.deleteField=function(e){a.a.request({method:"DELETE",url:a.a.forum.attribute("apiUrl")+"/masquerade/fields/"+e.id()}).then(this.requestSuccess.bind(this))},n.submitAddField=function(e){e.preventDefault();var t=this.new;a.a.request({method:"POST",url:a.a.forum.attribute("apiUrl")+"/masquerade/fields",data:t}).then(this.requestSuccess.bind(this)),this.resetNew(),m.redraw()},n.updateExistingField=function(e){if(e.id()){var t=e.data;a.a.request({method:"PATCH",url:a.a.forum.attribute("apiUrl")+"/masquerade/fields/"+e.id(),data:t}).then(this.requestSuccess.bind(this))}},n.requestSuccess=function(e){var t=a.a.store.pushPayload(e);t instanceof Array||!t.deleted_at()||a.a.store.remove(t),this.existing=a.a.store.all("masquerade-field"),this.existing.sort((function(e,t){return e.sort()<t.sort()?-1:e.sort()>t.sort()?1:0})),this.loading=!1,m.redraw()},n.loadExisting=function(){return this.loading=!0,a.a.request({method:"GET",url:a.a.forum.attribute("apiUrl")+"/masquerade/fields"}).then(this.requestSuccess.bind(this))},n.resetNew=function(){this.new={id:m.prop(),name:m.prop(""),description:m.prop(""),prefix:m.prop(""),icon:m.prop(""),required:m.prop(!1),on_bio:m.prop(!1),type:m.prop(null),validation:m.prop("")}},n.readyToAdd=function(e){return!!e.name()},n.availableTypes=function(){return{url:a.a.translator.trans("fof-masquerade.admin.types.url"),email:a.a.translator.trans("fof-masquerade.admin.types.email"),boolean:a.a.translator.trans("fof-masquerade.admin.types.boolean"),select:a.a.translator.trans("fof-masquerade.admin.types.select"),null:a.a.translator.trans("fof-masquerade.admin.types.advanced")}},t}(oe.a),he=function(){app.routes["fof-masquerade-configure-profile"]={path:"/fof/masquerade/configure",component:me.component()},app.extensionSettings["fof-masquerade"]=function(){return m.route(app.route("fof-masquerade-configure-profile"))},Object(r.extend)(u.a.prototype,"items",(function(e){e.add("fof-masquerade-configure-profile",c.a.component({href:app.route("fof-masquerade-configure-profile"),icon:"far fa-id-card",children:"Masquerade",description:app.translator.trans("fof-masquerade.admin.menu.description")}))}))};a.a.initializers.add("fof-masquerade",(function(e){e.store.models["masquerade-field"]=l.a,Object(r.extend)(s.a.prototype,"viewItems",(function(t){t.add("masquerade-view-profile",{icon:"far fa-id-card",label:e.translator.trans("fof-masquerade.admin.permissions.view-profile"),permission:"fof.masquerade.view-profile",allowGuest:!0})})),Object(r.extend)(s.a.prototype,"startItems",(function(t){t.add("masquerade-have-profile",{icon:"far fa-id-card",label:e.translator.trans("fof-masquerade.admin.permissions.have-profile"),permission:"fof.masquerade.have-profile"})})),he()}))}]);
//# sourceMappingURL=admin.js.map